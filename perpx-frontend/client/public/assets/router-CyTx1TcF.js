import{s as A}from"./vendor-u-BdebpYPG.js";import{p as B}from"./vendor-r-C3wvULIb.js";import{r as o,R as F}from"./react-Csfw9abt.js";const M=F.useInsertionEffect,N=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",V=N?o.useLayoutEffect:o.useEffect,T=M||V,L=e=>{const t=o.useRef([e,(...n)=>t[0](...n)]).current;return T(()=>{t[0]=e}),t[1]},$="popstate",p="pushState",E="replaceState",q="hashchange",b=[$,p,E,q],z=e=>{for(const t of b)addEventListener(t,e);return()=>{for(const t of b)removeEventListener(t,e)}},S=(e,t)=>A.useSyncExternalStore(z,e,t),k=()=>location.search,G=({ssrSearch:e}={})=>S(k,e!=null?()=>e:k),w=()=>location.pathname,J=({ssrPath:e}={})=>S(w,e!=null?()=>e:w),Q=(e,{replace:t=!1,state:n=null}={})=>history[t?E:p](n,"",e),W=(e={})=>[J(e),Q],R=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[R]>"u"){for(const e of[p,E]){const t=history[e];history[e]=function(){const n=t.apply(this,arguments),s=new Event(e);return s.arguments=arguments,dispatchEvent(s),n}}Object.defineProperty(window,R,{value:!0})}const X=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?"~"+t:t.slice(e.length)||"/",O=(e="")=>e==="/"?"":e,Y=(e,t)=>e[0]==="~"?e.slice(1):O(t)+e,Z=(e="",t)=>X(x(O(e)),x(t)),x=e=>{try{return decodeURI(e)}catch{return e}},j={hook:W,searchHook:G,parser:B,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:e=>e},_=o.createContext(j),d=()=>o.useContext(_),H={},I=o.createContext(H),ee=()=>o.useContext(I),y=e=>{const[t,n]=e.hook(e);return[Z(e.base,t),L((s,r)=>n(Y(s,e.base),r))]},ce=()=>y(d()),K=(e,t,n,s)=>{const{pattern:r,keys:u}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||"*",s),i=r.exec(n)||[],[l,...f]=i;return l!==void 0?[!0,(()=>{const a=u!==!1?Object.fromEntries(u.map((m,P)=>[m,f[P]])):i.groups;let c={...f};return a&&Object.assign(c,a),c})(),...s?[l]:[]]:[!1,null]},te=({children:e,...t})=>{const n=d(),s=t.hook?j:n;let r=s;const[u,i=t.ssrSearch??""]=t.ssrPath?.split("?")??[];u&&(t.ssrSearch=i,t.ssrPath=u),t.hrefs=t.hrefs??t.hook?.hrefs,t.searchHook=t.searchHook??t.hook?.searchHook;let l=o.useRef({}),f=l.current,a=f;for(let c in s){const m=c==="base"?s[c]+(t[c]??""):t[c]??s[c];f===a&&m!==a[c]&&(l.current=a={...a}),a[c]=m,(m!==s[c]||m!==r[c])&&(r=a)}return o.createElement(_.Provider,{value:r,children:e})},C=({children:e,component:t},n)=>t?o.createElement(t,{params:n}):typeof e=="function"?e(n):e,ne=e=>{let t=o.useRef(H);const n=t.current;return t.current=Object.keys(e).length!==Object.keys(n).length||Object.entries(e).some(([s,r])=>r!==n[s])?e:n},ae=({path:e,nest:t,match:n,...s})=>{const r=d(),[u]=y(r),[i,l,f]=n??K(r.parser,e,u,t),a=ne({...ee(),...l});if(!i)return null;const c=f?o.createElement(te,{base:f},C(s,a)):C(s,a);return o.createElement(I.Provider,{value:a,children:c})},ue=o.forwardRef((e,t)=>{const n=d(),[s,r]=y(n),{to:u="",href:i=u,onClick:l,asChild:f,children:a,className:c,replace:m,state:P,...U}=e,v=L(h=>{h.ctrlKey||h.metaKey||h.altKey||h.shiftKey||h.button!==0||(l?.(h),h.defaultPrevented||(h.preventDefault(),r(i,e)))}),g=n.hrefs(i[0]==="~"?i.slice(1):n.base+i,n);return f&&o.isValidElement(a)?o.cloneElement(a,{onClick:v,href:g}):o.createElement("a",{...U,onClick:v,href:g,className:c?.call?c(s===i):c,children:a,ref:t})}),D=e=>Array.isArray(e)?e.flatMap(t=>D(t&&t.type===o.Fragment?t.props.children:t)):[e],ie=({children:e,location:t})=>{const n=d(),[s]=y(n);for(const r of D(e)){let u=0;if(o.isValidElement(r)&&(u=K(n.parser,r.props.path,t||s,r.props.nest))[0])return o.cloneElement(r,{match:u})}return null};export{ue as L,ae as R,ie as S,ce as u};
